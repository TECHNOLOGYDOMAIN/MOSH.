<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title></title>
</head>
<body>
&lt;html&gt;<br/>
&lt;head&gt;<br/>
&lt;link rel=&quot;stylesheet&quot; href=&quot;main.css&quot;&gt;<br/>
&lt;script src=&quot;https://code.jquery.com/jquery-2.1.1.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;<br/>
&lt;/head&gt;&lt;?php include &quot;dbconfig.php&quot;; ?&gt;<br/>
&lt;script&gt;<br/>
function getTown(val) {<br/>
&nbsp;&nbsp;&nbsp;$.ajax({<br/>
&nbsp;&nbsp;&nbsp;type: &quot;POST&quot;,<br/>
&nbsp;&nbsp;&nbsp;url: &quot;get_town.php&quot;,<br/>
&nbsp;&nbsp;&nbsp;data:&#39;countryid=&#39;+val,<br/>
&nbsp;&nbsp;&nbsp;success: function(data){<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&quot;#town-list&quot;).html(data);<br/>
&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;});<br/>
}<br/>
function getClinic(val) {<br/>
&nbsp;&nbsp;&nbsp;$.ajax({<br/>
&nbsp;&nbsp;&nbsp;type: &quot;POST&quot;,<br/>
&nbsp;&nbsp;&nbsp;url: &quot;getclinic.php&quot;,<br/>
&nbsp;&nbsp;&nbsp;data:&#39;townid=&#39;+val,<br/>
&nbsp;&nbsp;&nbsp;success: function(data){<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&quot;#clinic-list&quot;).html(data);<br/>
&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;});<br/>
}<br/>
function getDoctorday(val) {<br/>
&nbsp;&nbsp;&nbsp;$.ajax({<br/>
&nbsp;&nbsp;&nbsp;type: &quot;POST&quot;,<br/>
&nbsp;&nbsp;&nbsp;url: &quot;getdoctordaybooking.php&quot;,<br/>
&nbsp;&nbsp;&nbsp;data:&#39;cid=&#39;+val,<br/>
&nbsp;&nbsp;&nbsp;success: function(data){<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&quot;#doctor-list&quot;).html(data);<br/>
&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;});<br/>
}<br/>
<br/>
function getDay(val) {<br/>
&nbsp;&nbsp;&nbsp;var cidval=document.getElementById(&quot;clinic-list&quot;).value;<br/>
&nbsp;&nbsp;&nbsp;var didval=document.getElementById(&quot;doctor-list&quot;).value;<br/>
&nbsp;&nbsp;&nbsp;$.ajax({<br/>
&nbsp;&nbsp;&nbsp;type: &quot;POST&quot;,<br/>
&nbsp;&nbsp;&nbsp;url: &quot;getDay.php&quot;,<br/>
&nbsp;&nbsp;&nbsp;data:&#39;date=&#39;+val+&#39;&amp;cidval=&#39;+cidval+&#39;&amp;didval=&#39;+didval,<br/>
&nbsp;&nbsp;&nbsp;success: function(data){<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$(&quot;#datestatus&quot;).html(data);<br/>
&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;});<br/>
}<br/>
<br/>
&lt;/script&gt;<br/>
&lt;body style=&quot;background-image:url(images/book.png)&quot;&gt;<br/>
&nbsp;&nbsp;&nbsp;&lt;div class=&quot;header&quot;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li style=&quot;float:left;border-right:none&quot;&gt;&lt;a href=&quot;ulogin.php&quot; class=&quot;logo&quot;&gt;&lt;img src=&quot;images/LOGO.png&quot; width=&quot;30px&quot; height=&quot;30px&quot;&gt;&lt;strong&gt; M.O.S.H. &lt;/strong&gt;Medical Online Scheduling Helper&lt;/a&gt;&lt;/li&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;a href=&quot;book.php&quot;&gt;Book Now&lt;/a&gt;&lt;/li&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;&lt;a href=&quot;ulogin.php&quot;&gt;Home&lt;/a&gt;&lt;/li&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;<br/>
&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br/>
&nbsp;&nbsp;&nbsp;&lt;form action=&quot;book.php&quot; method=&quot;post&quot;&gt;<br/>
&nbsp;&nbsp;&nbsp;&lt;div class=&quot;sucontainer&quot; style=&quot;background-image:url(images/SHA.png)&quot;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;&lt;b&gt;Name:&lt;/b&gt;&lt;/label&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type=&quot;text&quot; placeholder=&quot;Enter Full name of patient&quot; name=&quot;fname&quot; required&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;&lt;b&gt;Gender&lt;/b&gt;&lt;/label&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;female&quot;&gt;Female<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;male&quot;&gt;Male<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type=&quot;radio&quot; name=&quot;gender&quot; value=&quot;other&quot;&gt;Other&lt;br&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label style=&quot;font-size:20px&quot; &gt;City:&lt;/label&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;select name=&quot;city&quot; id=&quot;city-list&quot; class=&quot;demoInputBox&quot;  onChange=&quot;getTown(this.value);&quot; style=&quot;width:100%;height:35px;border-radius:9px&quot;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option value=&quot;&quot;&gt;Select City&lt;/option&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql1=&quot;SELECT distinct(city) FROM clinic&quot;;<br/>
         $results=$conn-&gt;query($sql1); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while($rs=$results-&gt;fetch_assoc()) { <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option value=&quot;&lt;?php echo $rs[&quot;city&quot;]; ?&gt;&quot;&gt;&lt;?php echo $rs[&quot;city&quot;]; ?&gt;&lt;/option&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;?php<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/select&gt;<br/>
        &lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label style=&quot;font-size:20px&quot; &gt;Town:&lt;/label&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;select id=&quot;town-list&quot; name=&quot;Town&quot; onChange=&quot;getClinic(this.value);&quot; style=&quot;width:100%;height:35px;border-radius:9px&quot;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option value=&quot;&quot;&gt;Select Town&lt;/option&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/select&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label style=&quot;font-size:20px&quot; &gt;Clinic:&lt;/label&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;select id=&quot;clinic-list&quot; name=&quot;Clinic&quot; onChange=&quot;getDoctorday(this.value);&quot; style=&quot;width:100%;height:35px;border-radius:9px&quot;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option value=&quot;&quot;&gt;Select Clinic&lt;/option&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/select&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label style=&quot;font-size:20px&quot; &gt;Doctor:&lt;/label&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;select id=&quot;doctor-list&quot; name=&quot;Doctor&quot; onChange=&quot;getDate(this.value);&quot; style=&quot;width:100%;height:35px;border-radius:9px&quot;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;option value=&quot;&quot;&gt;Select Doctor&lt;/option&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/select&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&gt;&lt;b&gt;Date of Visit:&lt;/b&gt;&lt;/label&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input type=&quot;date&quot; name=&quot;dov&quot; onChange=&quot;getDay(this.value);&quot; min=&quot;&lt;?php echo date(&#39;Y-m-d&#39;);?&gt;&quot; max=&quot;&lt;?php echo date(&#39;Y-m-d&#39;,strtotime(&#39;+7 day&#39;));?&gt;&quot; required&gt;&lt;br&gt;&lt;br&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div id=&quot;datestatus&quot;&gt; &lt;/div&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class=&quot;container&quot;&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button type=&quot;submit&quot; style=&quot;position:center&quot; name=&quot;submit&quot; value=&quot;Submit&quot;&gt;Submit&lt;/button&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br/>
&lt;?php<br/>
session_start();<br/>
if(isset($_POST[&#39;submit&#39;]))<br/>
{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;include &#39;dbconfig.php&#39;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fname=$_POST[&#39;fname&#39;];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$gender=$_POST[&#39;gender&#39;];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$username=$_SESSION[&#39;username&#39;];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cid=$_POST[&#39;Clinic&#39;];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$did=$_POST[&#39;Doctor&#39;];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$dov=$_POST[&#39;dov&#39;];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$status=&quot;Booking Registered.Wait for the update&quot;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$timestamp=date(&#39;Y-m-d H:i:s&#39;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sql = &quot;INSERT INTO book (Username,Fname,Gender,CID,DID,DOV,Timestamp,Status) VALUES (&#39;$username&#39;,&#39;$fname&#39;,&#39;$gender&#39;,&#39;$cid&#39;,&#39;$did&#39;,&#39;$dov&#39;,&#39;$timestamp&#39;,&#39;$status&#39;) &quot;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!empty($_POST[&#39;fname&#39;])&amp;&amp;!empty($_POST[&#39;gender&#39;])&amp;&amp;!empty($_SESSION[&#39;username&#39;])&amp;&amp;!empty($_POST[&#39;Clinic&#39;])&amp;&amp;!empty($_POST[&#39;Doctor&#39;]) &amp;&amp; !empty($_POST[&#39;dov&#39;]))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$checkday = strtotime($dov);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$compareday = date(&quot;l&quot;, $checkday);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$flag=0;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;require_once(&quot;dbconfig.php&quot;);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$query =&quot;SELECT * FROM doctor_availability WHERE DID = &#39;&quot; .$did. &quot;&#39; AND CID=&#39;&quot;.$cid.&quot;&#39;&quot;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$results = $conn-&gt;query($query);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while($rs=$results-&gt;fetch_assoc())<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($rs[&quot;day&quot;]==$compareday)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$flag++;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($flag==0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &quot;&lt;h2&gt;Select another date as Doctor Unavailable on &quot;.$compareday.&quot;&lt;/h2&gt;&quot;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (mysqli_query($conn, $sql)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &quot;&lt;h2&gt;Booking successful!! Redirecting to home page....&lt;/h2&gt;&quot;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header( &quot;Refresh:2; url=ulogin.php&quot;);<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &quot;Error: &quot; . $sql . &quot;&lt;br&gt;&quot; . mysqli_error($conn);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo &quot;Enter data properly!!!!&quot;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
}<br/>
?&gt;<br/>
&nbsp;&nbsp;&nbsp;&lt;/form&gt;<br/>
&lt;/body&gt;<br/>
&lt;/html&gt;</body></html>